<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.pjt.model.dao.CommentDao">

	<select id="selectAllComments" resultType="Comment">
		SELECT
		c.comment_id as commentId,
		c.comment_content as commentContent,
		c.user_id as userId,
		c.article_id as articleId,
		c.created_at as createdAt,
		c.modified_at as modifiedAt,
		c.comment_like as commentLike,
		c.comment_dislike as commentDislike,
		u.nickname
		FROM comment c
		JOIN user u ON c.user_id = u.user_id
		WHERE c.article_id = #{articleId}
	</select>

	<insert id="insertComment" parameterType="Comment">
		INSERT INTO comment
		(comment_content, user_id, article_id, nickname)
		VALUES (#{commentContent}, #{userId}, #{articleId}, #{nickname})
	</insert>

	<update id="updateComment" parameterType="Comment">
		UPDATE comment
		SET
		comment_content = #{commentContent},
		modified_at = now()
		WHERE comment_id = #{commentId}

	</update>

	<delete id="deleteComment" parameterType="int">
		DELETE FROM comment
		WHERE comment_id = #{commentId}

	</delete>
	
	<update id="plusCommentLikes" parameterType="int">
		UPDATE comment
		SET
		comment_like = comment_like + 1
		WHERE comment_id = #{commentId}
	</update>
	
	<update id="minusCommentLikes" parameterType="int">
		UPDATE comment
		SET
		comment_like = comment_like - 1
		WHERE comment_id = #{commentId}
	</update>
	
	<update id="plusCommentDislikes" parameterType="int">
		UPDATE comment
		SET
		comment_dislike = comment_dislike + 1
		WHERE comment_id = #{commentId}
	</update>
	
	<update id="minusCommentDislikes" parameterType="int">
		UPDATE comment
		SET
		comment_dislike = comment_dislike - 1
		WHERE comment_id = #{commentId}
	</update>
	
</mapper>